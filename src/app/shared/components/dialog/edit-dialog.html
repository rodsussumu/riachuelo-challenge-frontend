<h2 mat-dialog-title class="dlg-title">
  <div class="title-row">
    <mat-icon aria-hidden="true">edit_calendar</mat-icon>
    <span>{{ data ? 'Editar Tarefa' : 'Nova Tarefa' }}</span>
    <span class="spacer"></span>
    <button mat-icon-button mat-dialog-close aria-label="Fechar">
      <mat-icon>close</mat-icon>
    </button>
  </div>
</h2>

<mat-dialog-content class="dlg-content">
  <form [formGroup]="form" class="form" (ngSubmit)="save()">
    <mat-form-field appearance="outline" class="full">
      <mat-label>Título</mat-label>
      <input matInput formControlName="title" autocomplete="off" maxlength="100" />
      <mat-hint align="end">{{ f.title.value.length || 0 }}/100</mat-hint>
      @if(f.title.hasError('required')) {
      <mat-error>Título é obrigatório</mat-error>
      } @if(f.title.hasError('minlength')) {
      <mat-error>Mínimo de 3 caracteres</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="outline" class="full">
      <mat-label>Descrição</mat-label>
      <input matInput formControlName="description" autocomplete="off" maxlength="255" />
      <mat-hint align="end">{{ f.description.value.length || 0 }}/255</mat-hint>
      @if(f.description.hasError('required')) {
      <mat-error>Descrição é obrigatória</mat-error>
      } @if(f.description.hasError('minlength')) {
      <mat-error>Mínimo de 3 caracteres</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="outline" class="full">
      <mat-label>Data de vencimento</mat-label>
      <input matInput [matDatepicker]="picker" formControlName="dueDate" />
      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-datepicker
        #picker
        [startAt]="f.dueDate.value || today"
        startView="month"
      ></mat-datepicker>
      <mat-hint align="start">Formato: dd/MM/aaaa</mat-hint>
      @if(f['dueDate'].hasError('required')) {
      <mat-error>Informe a data de vencimento</mat-error>
      } @if(f['dueDate'].hasError('minDate')) {
      <mat-error>Use hoje ou uma data futura</mat-error>
      }
    </mat-form-field>
  </form>
</mat-dialog-content>

<mat-dialog-actions align="end" class="dlg-actions">
  <button mat-button (click)="cancel()">Cancelar</button>
  <button mat-flat-button color="primary" (click)="save()" [disabled]="form.invalid">
    {{ data ? 'Atualizar' : 'Criar' }}
  </button>
</mat-dialog-actions>
